on: [push]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Check out source
        uses: actions/checkout@v3
      - name: Setup 'node16'
        uses: actions/setup-node@v3
        with:
          node-version: '16'
          cache: 'npm'
      - name: install dependencies
        run: |
          npm ci
          npm install -g @vercel/ncc
      - name: build 
        run: ncc build src/index.ts --license license.txt
      - name: Setup Git
        run: |
          git config user.name 'Ville Koskela'
          git config user.email 'ville.koskela@terveystalo.com'
      - name: Push build to repo
        run: |
          git add .
          git commit -m "new release build"
          git push origin main

  friday-job:
    needs: build
    runs-on: ubuntu-latest
    name: Hello Friday!
    steps:
      - name: Ask input
        id: friday
        uses: ville-koskela/github-friday1022-action@v1.1.0
        with:
          bump-type: patch
      - name: check output
        run: echo "success was ${{ steps.friday.outputs.success }}"
